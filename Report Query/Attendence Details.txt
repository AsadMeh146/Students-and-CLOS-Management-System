SELECT ClassAttendance.AttendanceDate,((Cast(R1.PresentStudents as float) / (CAST(R2.TotalStudents as float))) * 100) AS AttendencePercentage FROM (SELECT StudentAttendance.AttendanceId,COUNT(StudentAttendance.StudentId) AS PresentStudents FROM StudentAttendance INNER JOIN ClassAttendance ON StudentAttendance.AttendanceId = ClassAttendance.Id WHERE AttendanceStatus = 1 GROUP BY StudentAttendance.AttendanceId) AS R1 INNER JOIN ClassAttendance ON R1.AttendanceId = ClassAttendance.Id,(SELECT Count(Id) AS TotalStudents FROM Student WHERE Status = 5) AS R2